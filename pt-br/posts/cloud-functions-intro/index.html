<!doctype html><html lang=pt-br><head><title>Google Cloud Functions & Node - Visão Geral :: Blog do LG</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Uma análise introdutória da utilização de Node em cloud functions"><meta name=keywords content="serverless,cloud functions"><meta name=robots content="noodp"><link rel=canonical href=https://luizgribeiro.github.io/pt-br/posts/cloud-functions-intro/><link rel=stylesheet href=https://luizgribeiro.github.io/assets/style.css><link rel=apple-touch-icon href=https://luizgribeiro.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://luizgribeiro.github.io/img/favicon/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="luiz_gribeiro"><meta property="og:locale" content="pt-br"><meta property="og:type" content="article"><meta property="og:title" content="Google Cloud Functions & Node - Visão Geral"><meta property="og:description" content="Uma análise introdutória da utilização de Node em cloud functions"><meta property="og:url" content="https://luizgribeiro.github.io/pt-br/posts/cloud-functions-intro/"><meta property="og:site_name" content="Blog do LG"><meta property="og:image" content="https://luizgribeiro.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-06-07 00:00:00 +0000 UTC"></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Blog do LG</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/showcase></a></li><li><a href=/about>Sobre</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>Português ▾</li></ul><ul class="language-selector__more hidden"><li><a href=https://luizgribeiro.github.io/pt-br/>Português</a></li><li><a href=https://luizgribeiro.github.io/>English</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/showcase></a></li><li><a href=/about>Sobre</a></li><hr><li><a href=https://luizgribeiro.github.io/pt-br/>Português</a></li><li><a href=https://luizgribeiro.github.io/>English</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://luizgribeiro.github.io/pt-br/posts/cloud-functions-intro/>Google Cloud Functions & Node - Visão Geral</a></h1><div class=post-meta><span class=post-date>2022-06-07</span>
<span class=post-author>:: Luiz Guilherme Ribeiro</span></div><span class=post-tags>#<a href=https://luizgribeiro.github.io/pt-br/tags/cloud-functions/>cloud functions</a>&nbsp;
#<a href=https://luizgribeiro.github.io/pt-br/tags/gcp/>GCP</a>&nbsp;
#<a href=https://luizgribeiro.github.io/pt-br/tags/serverless/>serverless</a>&nbsp;
#<a href=https://luizgribeiro.github.io/pt-br/tags/node/>node</a>&nbsp;</span><div class=post-content><div><h2 id=introdução>Introdução:<a href=#introdução class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=um-pouco-de-contexto>Um pouco de contexto:<a href=#um-pouco-de-contexto class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Nas últimas semanas eu tive a oportunidade de conhecer melhor alguns produtos da GCP, o que tem sido uma jornada de bastante aprendizado,
muitos erros e alguns acertos.</p><p>Por conta disso, resolvi documentar minhas descobertas no formato de blog, e espero que este artigo seja tão esclarecedor para você quanto teria sido para mim há algum tempo atrás.
Nele, teremos uma visão geral das Google Cloud Functions com ênfase naquelas que são acionadas por requisições HTTP.</p><h3 id=cloud-functions>Cloud Functions<a href=#cloud-functions class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Cloud Functions é um dos serviços de &ldquo;serverless&rdquo; da GCP. Nele, a pessoa desenvolvedora fornece apenas uma função tratadora (handler), que é acionada quando um envento ou requisição específico ocorre. Esses eventos fornecem os dados que são processados pela função e, a partir deles, todo tipo de operações pode ser realizado, como armazenamento em bancos de dados, processamento e até requisições para outros serviços.
Uma das principais vantagens deste serviço é que não é preciso se preocupar com infraestrutura. Aspectos como gerenciar máquinas virtuais, atualizar sistemas operacionais e configurar regras de firewall são, portanto, desnecessários, pois toda a parte de infra fica a cargo da GCP.</p><h2 id=pontos-principais-tldr>Pontos principais (TLDR):<a href=#pontos-principais-tldr class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Os pontos abaixo são as questões que achei mais importantes entre as minhas descobertas.
Elas se encontram descritas com mais detalhes logo abaixo.</p><ol><li>Uma requisição por vez por instância</li><li>Um handler por função</li><li>Express &ldquo;builtin&rdquo;</li><li>Functions framework</li></ol><h2 id=uma-requisição-por-instância>Uma requisição por instância<a href=#uma-requisição-por-instância class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Apesar de operações concorrentes poderem ser realizadas por uma cloud function através de Promises ou async/await, uma instância criada pela GCP para executar uma determinada cloud function trata apenas uma requisição por vez. Isso significa que, se uma requisição for realizada enquanto uma outra requisição está sendo processada, o serviço criará uma nova instância para que o processamento da nova requisição seja realizado. Em linhas gerais a criação de uma nova instância se traduz em uma maior latência (demora), pois o processo de iniciar uma nova instância demanda tempo.</p><h2 id=um-handler-por-função>Um handler por função<a href=#um-handler-por-função class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Pela forma como o serviço foi planejado, um único ponto de entrada é passado como handler. Dessa forma, quando uma requisição é feita apenas a função definida como ponto de entrada é chamada. Uma <del>gambiarra</del> solução muito utilizada para que seja possível acionar diferenter funcionalidades em um mesmo handler é utilizar um parâmetro de rota junto com switch/case para definir qual função deve ser chamada dentro de um mesmo handler.</p><h2 id=express-builtin>Express &ldquo;builtin&rdquo;<a href=#express-builtin class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Em HTTP functions que utilizam Node um servidor Express é utilizado como base. Na realidade, o handler abordado no ponto anterior é uma única rota do Express para qual a cloud function é mapeada.</p><h2 id=functions-framework>Functions Framework<a href=#functions-framework class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Um framework muito utilizado no desenvolvimento neste tipo de aplicação é o serverless framework. No entanto, o suporte e documentação dele para cloud functions não chega perto de ser o mesmo fornecido para os lambdas da AWS.
Por conta disso, recomendo fortemente que, para auxiliar no desenvolvimento de cloud functions, o <a href=https://cloud.google.com/functions/docs/functions-framework>Functions Framework</a> seja utilizado. Com ele é possível executar e realizar testes de forma local em um ambiente muito similar ao que uma Cloud Function é executada.</p></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://luizgribeiro.github.io/assets/main.js></script>
<script src=https://luizgribeiro.github.io/assets/prism.js></script>
<script src=https://luizgribeiro.github.io/assets/languageSelector.js></script></div></body></html>